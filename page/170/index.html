<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客">
<meta property="og:url" content="https://luna.newban.cn/page/170/index.html">
<meta property="og:site_name" content="开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://luna.newban.cn/page/170/">





  <title>开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
  
<a href="https://www.github.com/songjianzaina" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者的博客 – 全栈</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://www.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="http://code.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../amazonwebservices使用客户端应用程序在非SSL中更新AmazonRDSSSLTLS证书堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../amazonwebservices使用客户端应用程序在非SSL中更新AmazonRDSSSLTLS证书堆栈内存溢出.html" itemprop="url">amazonwebservices使用客户端应用程序在非SSL中更新AmazonRDSSSLTLS证书堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
Update Amazon RDS SSL/TLS certificates in non ssl using client application


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
最近，我收到了来自亚马逊的消息/通知

在2020年3月5日之前更新您的Amazon RDS SSL / TLS证书 为避免使用RDS和Aurora数据库中断应用程序，请在2020年3月5日之前更新这些数据库的证书颁发机构（CA）证书。我们强烈建议在2020年2月5日之前进行更新，以留出时间进行部署，测试和验证。 2020年1月14日之后创建的新数据库将默认使用新的CA证书。 确保首先使用新证书更新客户端应用程序。 查找新的CA证书和信息：RDS Aurora。

RDS中的数据库实例很少，我们通过不带SSL的客户端/ php应用程序连接它们。 所以，这是我的问题，我们仍然需要更新Amazon RDS SSL / TLS证书吗？ 如果这样做，是否仍需要更新客户端应用程序以使用SSL？

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：1</strong></p>

我们通过没有SSL的客户端/ php应用程序连接它们 所以，这是我的问题，我们仍然需要更新Amazon RDS SSL / TLS证书吗？ 不，您不需要在RDS实例上更新SSL / TLS证书，尽管Amazon最终会自动为您这样做。 如果这样做，是否仍需要更新客户端应用程序以使用SSL？ 不需要。如果您不必在客户端应用程序中安装以前的SSL证书，那么为什么需要在客户端应用程序中安装新版本？

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../amazonwebservices使用RESTAPI检索AmazonCloudWatch警报堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../amazonwebservices使用RESTAPI检索AmazonCloudWatch警报堆栈内存溢出.html" itemprop="url">amazonwebservices使用RESTAPI检索AmazonCloudWatch警报堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
Retrieve Amazon CloudWatch Alarms using REST API


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我正在尝试使用REST API GET从Amazon Monitoring Tool：Cloudwatch检索所有打开的警报（警报）。

尽管Azure Monitor的文档非常清晰，其中包含警报管理端点： https ://management.azure.com/subscriptions/ {SubscriptionID} /providers/Microsoft.AlertsManagement/alerts?includeContext=True&api-version=2018-05- 05

另一方面，在亚马逊方面。 我很困惑。

阅读完Amazon Cloudwatch文档之后。 我知道我需要从Cloudwatch警报中提取数据，而不是从Cloudwatch Log或Cloudwatch Events中提取数据。

但是我没有找到可用的相应端点，以便从可用的AWS服务点通过REST API Get检索Cloudwatch中所有打开的警报（警报）： https : //docs.aws.amazon.com/general/ Latest / gr / rande.html

有人可以对此有所启发吗？

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：0</strong></p>

https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/ruby/example_code/cloudwatch/cw-ruby-example-show-alarms.rb 这是一个describe alarms端点的红宝石示例。 您还应该能够使用其他编程语言执行相同的操作。

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../amazonwebservices为ReactNative项目设置后端的最佳方法是什么对于初学者关闭堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../amazonwebservices为ReactNative项目设置后端的最佳方法是什么对于初学者关闭堆栈内存溢出.html" itemprop="url">amazonwebservices为ReactNative项目设置后端的最佳方法是什么对于初学者关闭堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
What is the best method for setting up a backend for a react native project? (for a beginner) [closed]


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
想改善这个问题吗？ 想改善这个问题吗？ 更新问题，使其仅通过编辑此帖子来关注一个问题。 1小时前关闭。

我正在上关于udemy的本机课程，并且对前端开发非常满意，但是没有经验，也几乎不知道如何为该项目做后端。

后端有很多在线文档，用于用户身份验证，因此我对此并不担心，但是该应用程序的功能之一是它可以发送自动生成的电子邮件，而无需在用户的移动设备上打开电子邮件应用程序（因此它将由后端发送）。

应用程序可以使用哪些服务来使其具有此功能？

到目前为止，我已经对Firebase和AWS进行了一些研究，但是考虑到我的经验，我不认为最好询问并获得一些建议/信息，以用于后端的服务。

尽管我是一个初学者，但是我已经准备好动手了，因此，只要有足够的在线文档来使它工作，我就会接受任何具有较陡峭学习曲线的后端设置。

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：0 已采纳</strong></p>

我建议您开始使用Firebase。 这是最容易设置的，并且YouTube和Medium提供了很多教程。 这将使您有机会深入了解Express和GraphQL之类的内容。 最好的选择是找到要实现的目标的现有模式，并构建适合您目的的类似内容。

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../amazonwebservicesAWSlambda无法导入模块lambdafunction没有名为PIL的模块堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../amazonwebservicesAWSlambda无法导入模块lambdafunction没有名为PIL的模块堆栈内存溢出.html" itemprop="url">amazonwebservicesAWSlambda无法导入模块lambdafunction没有名为PIL的模块堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
AWS lambda Unable to import module 'lambda_function': No module named PIL


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我正在使用SearchFacesbyimage的lambda函数，并且正在使用此文档https://aws.amazon.com/blogs/machine-learning/build-your-own-face-recognition-service-using-amazon-rekognition/

我在哪里比较

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br></pre></td></tr></table></figure>


而且我收到此错误Unable to import module 'lambda_function': No module named PIL

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：1</strong></p>

之所以会出现此错误，是因为Python 2.x的PIL或3.x的PILLOW在python lambda环境中不是标准库。 要使用这样的库，您必须为所有需要的库以及要部署的python代码制作一个自定义部署包。 可以在docker中或使用EC2实例轻松制作此软件包。 这是在EC2上制作该部署程序包的过程： 假设您的文件名为CreateThumbnail.py 如果您的源代码在本地主机上，请将其复制到EC2。 scp -i key.pem /path/to/my_code.py ec2-user @ public-ip-address：〜/ CreateThumbnail.py 通过SSH连接到64位Amazon Linux实例。 ssh -i key.pem ec2-user @ public-ip-address 使用以下步骤安装Python 3.6和virtualenv： a） sudo yum install -y gcc zlib zlib-devel openssl openssl-devel b） wget https://www.python.org/ftp/python/3.6.1/Python-3.6.1.tgz c） tar -xzvf Python-3.6.1.tgz d） cd Python-3.6.1 && ./configure && make e） sudo make install f sudo / usr / local / bin / pip3安装virtualenv 选择通过pip3安装的虚拟环境 / usr / local / bin / virtualenv〜/ shrink_venv 源〜/ shrink_venv / bin / activate 在虚拟环境中安装库 点安装枕头 点安装boto3 将lib和lib64站点软件包的内容添加到您的.zip文件中。 请注意，以下步骤假定您使用的是Python运行时版本3.6。 如果您使用的是2.7版，则需要进行相应的更新。 cd $ VIRTUAL_ENV / lib / python3.6 / site-packages zip -r9〜/ CreateThumbnail.zip 注意-要包括所有隐藏文件，请使用以下选项： zip -r9〜/ CreateThumbnail.zip 将您的python代码添加到.zip文件 光盘〜 zip -g CreateThumbnail.zip CreateThumbnail.py 现在， CreateThumbnail.zip是您的自定义部署程序包，只需将其复制到s3并将其上传到您的lambda。 该示例摘自AWS官方文档， 网址为https://docs.aws.amazon.com/lambda/latest/dg/with-s3-example-deployment-pkg.html
**===============>>#2 票数：1**

即使文档清楚地概述了用于为lambda函数手动创建zip工件的步骤。 该解决方案不是很可扩展。 我一直在使用一个名为juniper的非常小的程序包来无缝打包python lambda函数。 在您的特定情况下，这是您需要采取的步骤： 假设这是您的文件夹结构： 在requirements.txt中，您将仅包括lambda函数的依赖项，在这种情况下，包括PIL库。 现在，您只需要创建一个小文件来告诉Juniper Zip文件中包括什么。 manifest.yml如下所示： 现在，您需要在本地环境pip install juniper 。 执行cli命令： 瞻博网络将创建： ./dist/reko.zip 。 该文件将具有您的源代码以及您在requirements.txt文件中包括的所有依赖项。 默认情况下，juniper使用docker容器，而build命令将使用python3.6。 您可以覆盖该默认值。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> .</span><br><span class="line">├── manifest.yml</span><br><span class="line">├── src</span><br><span class="line">│   ├── requirements.txt</span><br><span class="line">│   ├── lambda_function.py</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#3 票数：0</strong></p>

我也遇到了同样的问题。 您可以在此处执行两个步骤：手动打包和自动打包打包。 手动步骤将涉及创建正确的virtualenv并在该虚拟环境中安装依赖项。 然后压缩所有内容并上传到AWS。 为了使内容自动化，我始终喜欢使用无服务器框架来打包和部署Lambda函数。 特别是python-requirements-plugin有助于打包。 但是我必须指定以下内容来告诉框架在docker容器中构建并且不剥离任何库：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">custom:</span><br><span class="line"> pythonRequirements:</span><br><span class="line">   dockerizePip: true</span><br><span class="line">   strip: false</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../amazonwebservicesAWSEMR步骤找不到从s3导入的jar堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../amazonwebservicesAWSEMR步骤找不到从s3导入的jar堆栈内存溢出.html" itemprop="url">amazonwebservicesAWSEMR步骤找不到从s3导入的jar堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
AWS EMR step doens't find jar imported from s3


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我试图在客户端模式下在aws emr上运行spark应用程序。 我已经设置了一个引导操作，以从s3导入所需的文件和jar，并且我有一个步骤可以运行单个spark作业。

但是，当执行该步骤时，找不到我导入的jar。 这是stderr输出：

19/12/01 13:42:05警告DependencyUtils：本地jar / mnt / var / lib / hadoop / steps / s-2HLX7KPZCA07B /〜/ myApplicationDirectory不存在，正在跳过。

我能够将s3桶和应用程序所需的其他文件从我的s3存储桶成功导入到主实例，只需通过引导操作将它们导入到home/ec2-user/myApplicationDirectory/myJar.jar 。

但是我不明白为什么该步骤在mnt / var / lib / hadoop / ... etc中查找jar。

这是cli配置的相关部分：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--steps &apos;[&#123;&quot;Args&quot;:[&quot;spark-submit&quot;, &quot;--deploy-mode&quot;,&quot;client&quot;, &quot;--num-executors&quot;,&quot;1&quot;, “--driver-java-options&quot;,&quot;-Xss4M&quot;, &quot;--conf&quot;,&quot;spark.driver.maxResultSize=20g&quot;, &quot;--class”,”myApplicationClass”, “~/myApplicationDirectory”, “myJar.jar&quot;, … application specific arguments and paths to folders here …], ”Type&quot;:&quot;CUSTOM_JAR&quot;,</span><br></pre></td></tr></table></figure>


谢谢你的帮助，

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：0</strong></p>

好像不明白~指的是主目录。 尝试将"~/myApplicationDirectory"更改为"/home/ec2-user/myApplicationDirectory" 。 有一点警告：在你的问题的样本中，直引号"聪明‘的是被混合’ “确保‘智能’引号不要在配置文件中结束了，或者你会得到非常混乱的错误消息。 。

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../capplicationHostconfig错误由于IIS共享配置的权限不足无法写入配置文件堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../capplicationHostconfig错误由于IIS共享配置的权限不足无法写入配置文件堆栈内存溢出.html" itemprop="url">capplicationHostconfig错误由于IIS共享配置的权限不足无法写入配置文件堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
applicationHost.config Error: Cannot write configuration file due to insufficient permissions with IIS shared configuration


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我使用Microsoft.Web.Administration.ServerManager类来管理Windows服务中的网站。

我在管理员代码中使用模拟功能，该用户有权修改我的applicationHost.config但是当我执行.CommitChanges();时，总是收到以下错误.CommitChanges(); 。

我的代码有一个例子。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">using (ServerManager svr = ServerManager.OpenRemote(args.IISName)) &#123; Site currentSite = svr.Sites.Where(item =&gt; item.Id == args.WebSite.Id).FirstOrDefault(); currentSite.Applications[0].VirtualDirectories[0].PhysicalPath = args.WebSite.PhysicalPath; svr.CommitChanges(); &#125;</span><br></pre></td></tr></table></figure>


我找到了这个解决方案 ，但是我的dcom属性对象是lock

您的应用程序中发生了未处理的异常。 如果您单击继续，应用程序将忽略此错误并尝试继续。 如果您单击退出，该应用程序将立即关闭。 FileName \\？\\ UNC [MY PATH] \\ applicationHost.config错误：由于权限不足，无法写入配置文件

我的设置是Windows 2008 R2，IIS 7.5，框架3.5，而我的applicationHost.config位于SAN上

我可以尝试什么？

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">See the end of this message for details on invoking just-in-time (JIT) debugging instead of this dialog box. ************** Exception Text ************** System.UnauthorizedAccessException: Filename: \\?\[MY PATH]\applicationHost.config Error: Cannot write configuration file due to insufficient permissions at Microsoft.Web.Administration.Interop.IAppHostWritableAdminManager.CommitChanges() at Microsoft.Web.Administration.ConfigurationManager.CommitChanges() at Microsoft.Web.Administration.ServerManager.CommitChanges() at Nms.IIS.Business.Manager.IISManager70.UpdateWebSiteEntity(UpdateWebSiteEntityArgs args) at Nms.IIS.Business.Service.IISService70.UpdateWebSiteEntity(UpdateWebSiteEntityArgs args) at IISSwitcher.Form1.btnProccess_Click(Object sender, EventArgs e) in C:\Form1.cs:line 70 at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent) at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks) at System.Windows.Forms.Control.WndProc(Message&amp; m) at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m) at System.Windows.Forms.Button.WndProc(Message&amp; m) at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m) at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m) at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) ************** Loaded Assemblies ************** mscorlib Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4952 (win7RTMGDR.050727-4900) CodeBase: file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll ---------------------------------------- IISSwitcher Assembly Version: 1.0.0.0 Win32 Version: 1.0.0.0 CodeBase: file://[mypatch]/Altitude3%20Transfert/IISDirectorySwitch/IISSwitcher.exe ---------------------------------------- System.Windows.Forms Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4927 (NetFXspW7.050727-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll ---------------------------------------- System Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4927 (NetFXspW7.050727-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll ---------------------------------------- System.Drawing Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4927 (NetFXspW7.050727-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll ---------------------------------------- Nms.IIS.Business Assembly Version: 1.0.295.8874 Win32 Version: 1.0.295.8874 CodeBase: file://[mypatch]/Altitude3%20Transfert/IISDirectorySwitch/Nms.IIS.Business.DLL ---------------------------------------- Nms.Core Assembly Version: 1.0.1954.8874 Win32 Version: 1.0.1954.8874 CodeBase: file://[mypatch]/Altitude3%20Transfert/IISDirectorySwitch/Nms.Core.DLL ---------------------------------------- System.Configuration Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4927 (NetFXspW7.050727-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Configuration/2.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll ---------------------------------------- System.Xml Assembly Version: 2.0.0.0 Win32 Version: 2.0.50727.4927 (NetFXspW7.050727-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Xml/2.0.0.0__b77a5c561934e089/System.Xml.dll ---------------------------------------- Microsoft.Practices.Unity Assembly Version: 1.2.0.0 Win32 Version: 1.2.0.0 CodeBase: file://[mypatch]/Altitude3%20Transfert/IISDirectorySwitch/Microsoft.Practices.Unity.DLL ---------------------------------------- Microsoft.Practices.Unity.Interception Assembly Version: 1.2.0.0 Win32 Version: 1.2.0.0 CodeBase: file://Microsoft.Practices.Unity.Interception.DLL ---------------------------------------- Microsoft.Practices.ObjectBuilder2 Assembly Version: 2.2.0.0 Win32 Version: 2.2.0.0 CodeBase: file://Microsoft.Practices.ObjectBuilder2.DLL ---------------------------------------- System.Core Assembly Version: 3.5.0.0 Win32 Version: 3.5.30729.4926 built by: NetFXw7 CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Core/3.5.0.0__b77a5c561934e089/System.Core.dll ---------------------------------------- Nms.Core.resources Assembly Version: 1.0.1954.8874 Win32 Version: 1.0.1954.8874 CodeBase: file://Nms.Core.resources.DLL ---------------------------------------- Unity_ILEmit_InterfaceProxies Assembly Version: 0.0.0.0 Win32 Version: 1.2.0.0 CodeBase: file://Microsoft.Practices.Unity.Interception.dll ---------------------------------------- Microsoft.Web.Administration Assembly Version: 7.0.0.0 Win32 Version: 6.1.7600.16385 CodeBase: file:///C:/Windows/assembly/GAC_MSIL/Microsoft.Web.Administration/7.0.0.0__31bf3856ad364e35/Microsoft.Web.Administration.dll ---------------------------------------- System.Runtime.Serialization Assembly Version: 3.0.0.0 Win32 Version: 3.0.4506.4926 (NetFXw7.030729-4900) CodeBase: file:///C:/Windows/assembly/GAC_MSIL/System.Runtime.Serialization/3.0.0.0__b77a5c561934e089/System.Runtime.Serialization.dll ---------------------------------------- ************** JIT Debugging ************** To enable just-in-time (JIT) debugging, the .config file for this application or computer (machine.config) must have the jitDebugging value set in the system.windows.forms section. The application must also be compiled with debugging enabled. For example: &lt;configuration&gt; &lt;system.windows.forms jitDebugging=&quot;true&quot; /&gt; &lt;/configuration&gt; When JIT debugging is enabled, any unhandled exception will be sent to the JIT debugger registered on the computer rather than be handled by this dialog box.</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：18</strong></p>

在我们的例子中，服务器磁盘已满。 我们添加了额外的磁盘空间，问题得以解决。
**===============>>#2 票数：14**

我已经从解决方案中删除了现有的applicationhost.config文件，然后再次重新加载了解决方案。 解决方案本身创建了新的ApplicationHost.config文件。 它解决了我的问题。
**===============>>#3 票数：8 已采纳**

要解锁dcom属性对象，只需执行2个步骤即可。 步骤1-在“ Ahadmin.dll”上授予您“完全控制”权限： 第2步-在注册表项上授予您“完全控制”权限： 如果您无法授予“完全控制”权限，请转到“所有者”选项卡并添加您所属的NT用户或管理员组，然后单击“应用”，然后返回“安全性”选项卡进行授予你“完全控制” 现在，您可以编辑dcom属性对象 如果dcom porperties对象仍然处于锁定状态，请等待几分钟，然后重试。 之后，您只需要按照此处的步骤进行操作即可。
**===============>>#4 票数：2**

确保包含项目的文件夹未加密。 Visual Studio在使用加密文件夹时遇到问题。 我已经加密了用户文件夹，并且在将这些文件夹标记为未加密之前，这些项目才能打开。 VS没有提供有意义的错误，指出您应该从项目文件夹中删除加密，这是很愚蠢的。 要删除加密，请右键单击项目文件夹，然后单击“高级”，然后取消选中“加密”复选框。 将更改应用到文件夹本身以及所有嵌套的文件夹和文件。
**===============>>#5 票数：1**

确保文件的安全设置和共享的安全设置都允许模拟用户修改文件。 由于您要使用UNC路径访问配置文件，因此需要两个级别的权限。
**===============>>#6 票数：0**

虚拟目录是否映射到共享文件夹。 查看共享的权限，默认情况下在Windows 7 / w2k8下使用以下方式创建共享：每个人（读取）。 将共享的权限更改为：每个人（FullControl） 这使IIS可以通过共享来完成所需的操作，因为它没有使用完整的物理路径。

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../cmakecmake的依赖没有触发堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../cmakecmake的依赖没有触发堆栈内存溢出.html" itemprop="url">cmakecmake的依赖没有触发堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
cmake dependency not trigged


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我尝试在项目中使用cmake（实际上是从make转到cmake）。 我遇到一个我无法解决的问题。 我试图像这样简化我的架构（希望这不是太简化）。 我在这里使用ld -r作为示例自定义命令，该命令生成文件和中间文件。

这是我的文件结构。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. `-- libs |-- CMakeLists.txt |-- l1 | |-- CMakeLists.txt | |-- l1_f1.c | `-- l1_f2.c `-- l2 |-- CMakeLists.txt |-- l2_f1.c `-- l2_f2.c</span><br></pre></td></tr></table></figure>


.c文件

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./libs/l1/l1_f1.c:: #include &lt;stdio.h&gt; int v1; int l1_f1()&#123; printf(&quot;In l1_f1()\n&quot;);&#125; ./libs/l1/l1_f2.c:: #include &lt;stdio.h&gt; int l1_f2()&#123; printf(&quot;In l1_f2()\n&quot;);&#125; ./libs/l2/l2_f1.c:: #include &lt;stdio.h&gt; int l2_f1()&#123; printf(&quot;In l2_f1()\n&quot;);&#125; ./libs/l2/l2_f2.c:: #include &lt;stdio.h&gt; int l2_f2()&#123; printf(&quot;In l2_f2()\n&quot;);&#125;</span><br></pre></td></tr></table></figure>


还有我的CMakeLists.txt文件

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./libs/CMakeLists.txt:: cmake_minimum_required(VERSION 3.10) project(PL VERSION 1.0) add_subdirectory(../libs/l1 libs/l1) add_subdirectory(../libs/l2 libs/l2) add_custom_command( OUTPUT l.a COMMAND ld -r libs/l1/l1.o libs/l2/l2.o -o l.o COMMAND rm -f l.a COMMAND ar r l.a l.o COMMAND rm -f l.o DEPENDS L1 L2 ) add_custom_target( LA ALL DEPENDS l.a ) ./libs/l1/CMakeLists.txt:: add_library(l1 OBJECT l1_f1.c l1_f2.c) add_custom_command( OUTPUT l1.o COMMAND ld -r $&lt;TARGET_OBJECTS:l1&gt; -o l1.o DEPENDS $&lt;TARGET_OBJECTS:l1&gt; COMMAND_EXPAND_LISTS ) add_custom_target( L1 ALL DEPENDS l1.o ) ./libs/l2/CMakeLists.txt:: add_library(l2 OBJECT l2_f1.c l2_f2.c) add_custom_command( OUTPUT l2.o COMMAND ld -r $&lt;TARGET_OBJECTS:l2&gt; -o l2.o DEPENDS $&lt;TARGET_OBJECTS:l2&gt; COMMAND_EXPAND_LISTS ) add_custom_target( L2 ALL DEPENDS l2.o )</span><br></pre></td></tr></table></figure>


现在的问题

我像这样运行原始的cmake

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir build &amp;&amp; cd build &amp;&amp; cmake -G Ninja ../libs &amp;&amp; ninja -- The C compiler identification is GNU 7.4.0 -- The CXX compiler identification is GNU 7.4.0 -- Check for working C compiler: /usr/bin/cc -- Check for working C compiler: /usr/bin/cc -- works -- Detecting C compiler ABI info -- Detecting C compiler ABI info - done -- Detecting C compile features -- Detecting C compile features - done -- Check for working CXX compiler: /usr/bin/g++ -- Check for working CXX compiler: /usr/bin/g++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/phi/p2/build [7/7] Generating l.a ar: creating l.a</span><br></pre></td></tr></table></figure>


我对创建la感到满意，并对它执行nm（1）显示v1全局变量。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nm l.a l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v1</span><br></pre></td></tr></table></figure>


现在的问题，我触摸了1个文件l1_f1.c并重建

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ sed -i &apos;s/v1/v2/&apos; ../libs/l1/l1_f1.c VY$ ninja [2/2] Generating l1.o</span><br></pre></td></tr></table></figure>


正如我们在这里看到的那样，la并没有重建，尽管我以为我已经对其进行了重建。 很明显我一定是错的，我是cmake的新手。

nm（1）确认la没有被再生。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ nm l.a libs/l1/l1.o l.a: l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v1 libs/l1/l1.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 U puts 0000000000000004 C v2</span><br></pre></td></tr></table></figure>


有人能启发我如何重生吗？

提前感谢，加油。

1）在主CMakeLists.txt中添加文件级依赖项会阻止初始构建。 请注意，您的第一行DEPENDS libs/l1/l1.o libs/l1/l2.o在源树而不是构建树中查找文件时会产生错误，因此我将其更改为DEPENDS ../build/libs/l1/l1.o ../build/libs/l2/l2.o

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.10) project(PL VERSION 1.0) add_subdirectory(../libs/l1 libs/l1) add_subdirectory(../libs/l2 libs/l2) add_custom_command( OUTPUT l.a COMMAND ld -r libs/l1/l1.o libs/l2/l2.o -o l.o COMMAND rm -f l.a COMMAND ar r l.a l.o COMMAND rm -f l.o DEPENDS ../build/libs/l1/l1.o ../build/libs/l2/l2.o DEPENDS L1 L2 ) add_custom_target( LA ALL DEPENDS l.a )</span><br></pre></td></tr></table></figure>


这将在初始构建时提供以下输出

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ cd .. &amp;&amp; rm -rf build &amp;&amp; mkdir build &amp;&amp; cd build &amp;&amp; cmake -G Ninja ../libs &amp;&amp; ninja -- The C compiler identification is GNU 7.4.0 -- The CXX compiler identification is GNU 7.4.0 ... [removed output] -- Configuring done -- Generating done -- Build files have been written to: /home/phi/p2/build ninja: error: &apos;/home/phi/p2/build/libs/l1/l1.o&apos;, needed by &apos;l.a&apos;, missing and no known rule to make it</span><br></pre></td></tr></table></figure>


2）重建没有文件级dep的项目。 VY $ cd .. && rm -rf生成&& mkdir生成&& cd生成&& cmake -G忍者../libs && ninja

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-- The C compiler identification is GNU 7.4.0 -- The CXX compiler identification is GNU 7.4.0 ... [removed output] -- Configuring done -- Generating done -- Build files have been written to: /home/phi/p2/build [7/7] Generating l.a ar: creating l.a</span><br></pre></td></tr></table></figure>


3）有了这个初始构建，然后在CMake中再次添加了文件dep，然后要求进行部分重新构建

项目构建后的初始设置。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ ninja;nm libs/l1/CMakeFiles/l1.dir/l1_f1.c.o ; nm l.a ninja: no work to do. U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 U puts 0000000000000004 C v1 l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v1</span><br></pre></td></tr></table></figure>


这就是v1，触摸1个文件即可制作v2，并使用文件级dep进行重建

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.10) project(PL VERSION 1.0) add_subdirectory(../libs/l1 libs/l1) add_subdirectory(../libs/l2 libs/l2) add_custom_command( OUTPUT l.a COMMAND ld -r libs/l1/l1.o libs/l2/l2.o -o l.o COMMAND rm -f l.a COMMAND ar r l.a l.o COMMAND rm -f l.o DEPENDS ../build/libs/l1/l1.o ../build/libs/l2/l2.o DEPENDS L1 L2 ) add_custom_target( LA ALL DEPENDS l.a )</span><br></pre></td></tr></table></figure>


给这个

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ ninja [0/1] Re-running CMake... -- Configuring done -- Generating done -- Build files have been written to: /home/phi/p2/build [2/2] Generating l1.o VY$ nm libs/l1/CMakeFiles/l1.dir/l1_f1.c.o ; nm l.a U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 U puts 0000000000000004 C v2 l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v1 VY$ ninja [1/1] Generating l.a ar: creating l.a VY$ nm libs/l1/CMakeFiles/l1.dir/l1_f1.c.o ; nm l.a U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 U puts 0000000000000004 C v2 l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v2</span><br></pre></td></tr></table></figure>


正如我们在此处看到的，在第一个忍者上，我们进行了一次cmake重建，因为我重新添加了文件级dep。 那么只有l1.o被重建而不是lo然后la

第二个忍者触发了la重建。

听起来像使基本依赖项actiopn规则对于cmake来说是很神奇的，希望有人可以在这里帮助我。

干杯。

Tsyvarev的最终修复程序使其正常工作，需要set_source_files_propoerties（）

顶部的CMakeLists.txt现在看起来像这样

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.10) project(PL VERSION 1.0) add_subdirectory(../libs/l1 libs/l1) add_subdirectory(../libs/l2 libs/l2) add_custom_command( OUTPUT l.a COMMAND ld -r $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l1/l1.o $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l2/l2.o -o l.o COMMAND rm -f l.a COMMAND ar r l.a l.o COMMAND rm -f l.o DEPENDS # Use absolute paths for files for prevent confusion $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l1/l1.o $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l2/l2.o # Target-level dependencies are needed too L1 L2 ) set_source_files_properties( $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l1/l1.o $&#123;CMAKE_CURRENT_BINARY_DIR&#125;/libs/l2/l2.o PROPERTIES GENERATED TRUE ) add_custom_target( LA ALL DEPENDS l.a )</span><br></pre></td></tr></table></figure>


而完整的和部分的构建会给出正确的答案。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VY$ cd .. &amp;&amp; rm -rf build &amp;&amp; mkdir build &amp;&amp; cd build &amp;&amp; cmake -G Ninja ../libs &amp;&amp; ninja -- The C compiler identification is GNU 7.4.0 -- The CXX compiler identification is GNU 7.4.0 -- Check for working C compiler: /usr/bin/cc -- Check for working C compiler: /usr/bin/cc -- works -- Detecting C compiler ABI info -- Detecting C compiler ABI info - done -- Detecting C compile features -- Detecting C compile features - done -- Check for working CXX compiler: /usr/bin/g++ -- Check for working CXX compiler: /usr/bin/g++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/phi/p2/build [7/7] Generating l.a ar: creating l.a VY$ ninja;nm libs/l1/CMakeFiles/l1.dir/l1_f1.c.o ; nm l.a ninja: no work to do. U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 U puts 0000000000000004 C v1 l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v1 VY$ sed -i &apos;s/v1/v2/&apos; ../libs/l1/l1_f1.c VY$ ninja;nm libs/l1/CMakeFiles/l1.dir/l1_f1.c.o ; nm l.a [3/3] Generating l.a ar: creating l.a U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 U puts 0000000000000004 C v2 l.o: U _GLOBAL_OFFSET_TABLE_ 0000000000000000 T l1_f1 0000000000000013 T l1_f2 0000000000000026 T l2_f1 0000000000000039 T l2_f2 U puts 0000000000000004 C v2</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：1 已采纳</strong></p>

正如我们在这里看到的那样， la并没有重建，尽管我以为我已经对其进行了重建。 其实你不使la依赖从l1.o和其他目标文件。 线 在创建la的定制命令中，仅意味着目标 LA （依赖于la的目标 ）与目标 L1和L2之间的依赖关系。 在add_custom_command的文档中add_custom_command进行了add_custom_command 。 但是您的自定义命令本身没有所需的l1.o 文件依赖l1.o 。 目标之间的依赖性迫使仅在L1和L2之后建立LA目标。 正确的方法是为add_custom_command 文件级别指定依赖项。 但是，由于在其他 CMakeLists.txt中创建了依赖项文件，因此还需要其他步骤： 结果： 即使您具有目标级的依赖关系，背后的原理也需要指定文件级的依赖关系，因为通常CMake并没有关于目标的OUTPUT文件的概念。 这种概念仅适用于由add_executable或add_library创建的目标，在这种情况下，来自此类目标的DEPENDS实际上丰富了具有目标级别和文件级别依赖性的自定义命令。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DEPENDS L1 L2</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../airflowadhoc运行的airflow命令行参数堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../airflowadhoc运行的airflow命令行参数堆栈内存溢出.html" itemprop="url">airflowadhoc运行的airflow命令行参数堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
airflow command line parameter for adhoc run?


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我们刚刚开始包括气流以进行调度。 我的脚本之一每天运行。 它使用模板参数（{{ds_nodash}}）获取日期。 但是我必须重新运行一天的负载（过去的日期），如何提供输入参数。 输入参数将覆盖ds_nodash。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I have : trade_acx_ld_cmd = &quot;/home/airflow/projects/wrapper/gen_bq_gcs_file_load.sh trade_acx.csv l1_gcb_trxn trade &#123;&#123; ds_nodash &#125;&#125; &quot; Would like to run for trade_acx_ld_cmd = &quot;/home/airflow/projects/wrapper/gen_bq_gcs_file_load.sh trade_acx.csv l1_gcb_trxn trade **20190601** &quot;</span><br></pre></td></tr></table></figure>


下面的代码段：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import os from airflow import DAG from airflow.operators.bash_operator import BashOperator from datetime import datetime, timedelta from airflow.contrib.operators.bigquery_operator import BigQueryOperator from airflow.contrib.operators.bigquery_check_operator import BigQueryCheckOperator default_args = &#123; &apos;owner&apos;: &apos;airflow&apos;, &apos;depends_on_past&apos;: False, &apos;start_date&apos;: datetime(2019, 6, 19), &apos;email&apos;: [&apos;sanjeeb@gmail.com&apos;], &apos;email_on_failure&apos;: False, &apos;email_on_retry&apos;: False, &apos;retries&apos;: 1, &apos;retry_delay&apos;: timedelta(minutes=5), # &apos;queue&apos;: &apos;bash_queue&apos;, # &apos;pool&apos;: &apos;backfill&apos;, # &apos;priority_weight&apos;: 10, # &apos;end_date&apos;: datetime(2016, 1, 1), &#125; dag = DAG(&apos;create-data-set-job&apos;, default_args=default_args) projct_dr=&apos;/home/airflow/projects/&apos; trade_acx_ld=&quot;/home/airflow/projects/wrapper/gen_bq_gcs_file_load.sh&quot; trade_acx_ld_cmd = &quot;/home/airflow/projects/wrapper/gen_bq_gcs_file_load.sh trade_acx.csv l1_gcb_trxn trade &#123;&#123; ds_nodash &#125;&#125; &quot; t1 = BashOperator( task_id=&apos;print_date&apos;, bash_command=&apos;date&apos;, dag=dag) if os.path.exists(trade_acx_ld): t2 = BashOperator( task_id= &apos;Dataset_create&apos;, bash_command=trade_acx_ld_cmd, dag=dag ) else: raise Exception(&quot;Cannot locate &#123;0&#125;&quot;.format(trade_acx_ld_cmd)) t2.set_upstream(t1)</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：0 已采纳</strong></p>

您可以使用airflow trigger_dag手动触发DAG。 {{ ds_nodash }}将采用execution_date日期，因此，如果您使用旧的执行日期来触发DAG，则{{ ds_nodash }}将使用较旧的execution_date日期而不是今天的日期。 您可以按以下方式将execution_date传递给trigger_dag命令。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airflow trigger_dag gcs-file-load-job -e &quot;2019-01-01&quot;</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#2 票数：0</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../c为什么我的表仅用ID填充空对象堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../c为什么我的表仅用ID填充空对象堆栈内存溢出.html" itemprop="url">c为什么我的表仅用ID填充空对象堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
Why does my table fills with empty objects with just Id?


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我的电影和顾客之间有很多关系。 但是每次我创建一个新客户并从下拉菜单中为该客户选择电影时，都会创建新客户，但电影版位为空，然后当我在数据库中检查我的电影表时，新电影将以空值创建来自新的电影ID。 而我的CustomerMovie表（许多关系表）将具有针对新电影ID的新客户ID。 为什么要通过吸引新客户来制作带有空值的新电影，并且不会将现有电影添加到客户中。

补充说明，我对Razor @Html标签不是很熟悉，所以我只使用了普通的For循环，至少在现在，它对我来说更有意义。

这是我的客户模型

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class Customer &#123; public Customer() &#123; this.Movies = new HashSet&lt;Movie&gt;(); &#125; public int id &#123; get; set; &#125; [StringLength(255)] public String Name &#123; get; set; &#125; public bool IsSubscribedToNewsletter &#123; get; set; &#125; public int CurrentMembershipTypeId &#123; get; set; &#125; public virtual MembershipType CurrentMembershipType &#123; get; set;&#125; public virtual ICollection&lt;Movie&gt; Movies &#123; get; set; &#125; &#125;</span><br></pre></td></tr></table></figure>


这是我的电影模特

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class Movie &#123; public Movie() &#123; this.Customers = new HashSet&lt;Customer&gt;(); &#125; public int Id &#123; get; set; &#125; //[Required(ErrorMessage = &quot;Name must be specified&quot;)] public string Name &#123; get; set; &#125; public virtual ICollection&lt;Customer&gt; Customers &#123; get; set; &#125; &#125; &#125;</span><br></pre></td></tr></table></figure>


这是我的上下文类：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerContext : DbContext &#123; public CustomerContext() : base(&quot;CustomerContext&quot;) &#123; &#125; public DbSet&lt;MembershipType&gt; MembershipTypes &#123; get; set; &#125; public DbSet&lt;Customer&gt; Customers &#123; get; set; &#125; public DbSet&lt;Movie&gt; Movies &#123; get; set; &#125; protected override void OnModelCreating(DbModelBuilder modelBuilder) &#123; modelBuilder.Entity&lt;Customer&gt;() .HasMany&lt;Movie&gt;(s =&gt; s.Movies) .WithMany(c =&gt; c.Customers) .Map(cs =&gt; &#123; cs.MapLeftKey(&quot;CustomerId&quot;); cs.MapRightKey(&quot;MovieId&quot;); cs.ToTable(&quot;CustomersMovies&quot;); &#125;); modelBuilder.Entity&lt;Customer&gt;() .HasRequired&lt;MembershipType&gt;(s =&gt; s.CurrentMembershipType) .WithMany(g =&gt; g.Customers) .HasForeignKey&lt;int&gt;(s =&gt; s.CurrentMembershipTypeId); &#125; &#125;</span><br></pre></td></tr></table></figure>


这是客户控制者：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerController : Controller &#123; // private ICustomerRepository iCustomerRepository; ICustomerRepository iCustomerRepository = new CustomerRepository(new CustomerContext()); IMembershipTypeRepository iMembershipTypeRepository = new MembershipTypeRepository(new CustomerContext()); IMovieRepository imovieRepository = new MovieRepository(new CustomerContext()); CustomerContext CustomerContext = new CustomerContext(); // GET: Customers public ActionResult Customer() &#123; var customers = CustomerContext.Customers.Include(c =&gt; c.Movies); var Customers = customers.ToList(); return View(Customers); &#125; //public ActionResult CustomerForm(Customer Customer) public ActionResult CustomerForm(Customer customer) &#123; var membershipTypes = iMembershipTypeRepository.GetMembershipTypes(); var Movie = imovieRepository.GetMovies(); ViewBag.Message = &quot;Customers form is going to display: &quot;; CustomerViewModel customerViewModel = new CustomerViewModel &#123; MembershipTypes = CustomerContext.MembershipTypes, Movies = CustomerContext.Movies, &#125;; if (customer.IsSubscribedToNewsletter != true) ViewBag.Addon = &quot;Selected&quot;; else ViewBag.Addon = &quot;Not Selected&quot;; return View(customerViewModel); &#125; public ActionResult Edit(int id) &#123; Customer Customer = new Customer(); Customer = iCustomerRepository.GetCustomerByID(id); CustomerViewModel customer = new CustomerViewModel &#123; MembershipTypes = CustomerContext.MembershipTypes, Movies = CustomerContext.Movies, Customer = Customer &#125;; return View(customer); &#125; [HttpPost] public ActionResult CustomerForm(int CustomerId, string CustomerName, bool CustomerisSubscribedToNewsLetter, int membershipTypeId, Movie movie) &#123; Customer customer = new Customer(); // Movie Movie = new Movie(); customer.id = CustomerId; customer.Name = CustomerName; customer.IsSubscribedToNewsletter = CustomerisSubscribedToNewsLetter; customer.CurrentMembershipTypeId = membershipTypeId; customer.Movies.Add(movie); movie.Customers.Add(customer); iCustomerRepository.InsertCustomer(customer); // imovieRepository.InsertMovie(movie); iCustomerRepository.Save(); // imovieRepository.Save(); return RedirectToAction(&quot;Customer&quot;); &#125; [HttpPost] public ActionResult Edit(int CustomerId, string CustomerName, bool CustomerIsSubscribedToNewsLetter, int membershipTypeId, IList&lt;Movie&gt; movie) &#123; Customer Customer = new Customer(); Customer.id = CustomerId; Customer.Name = CustomerName; Customer.IsSubscribedToNewsletter = CustomerIsSubscribedToNewsLetter; Customer.CurrentMembershipTypeId = membershipTypeId; Customer.Movies = movie; iCustomerRepository.UpdateCustomer(Customer); iCustomerRepository.Save(); //CustomerContext.Movies.AddRange(movie); imovieRepository.Save(); CustomerContext.SaveChanges(); return RedirectToAction(&quot;Customer&quot;); &#125; [HttpPost] public ActionResult Delete(int id) &#123; Customer customer = new Customer(); customer = iCustomerRepository.GetCustomerByID(id); iCustomerRepository.DeleteCustomer(customer.id); iCustomerRepository.Save(); return RedirectToAction(&quot;Customer&quot;); &#125; &#125;</span><br></pre></td></tr></table></figure>


这是我的电影控制器，目前仅列出所有功能：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class MovieController : Controller &#123; IMovieRepository iMovieRepository = new MovieRepository(new CustomerContext()); ICustomerRepository iCustomerRepository = new CustomerRepository(new CustomerContext()); CustomerContext CustomerContext = new CustomerContext(); public ActionResult Movie() &#123; var Movies = iMovieRepository.GetMovies(); //var movies = CustomerContext.Movies.Include(s =&gt; s.Customers); return View(Movies); &#125; &#125;</span><br></pre></td></tr></table></figure>


这是customerform视图：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@model WebApplication2.ViewModel.CustomerViewModel @*&lt;h4&gt; &lt;b&gt;ID:&lt;/b&gt; @ViewBag.id &lt;br /&gt; &lt;b&gt;Name:&lt;/b&gt; @ViewBag.Name &lt;br /&gt; &lt;b&gt;Addon:&lt;/b&gt; @ViewBag.Addon &lt;br /&gt; &lt;/h4&gt; &lt;h2&gt;CustomerForm&lt;/h2&gt; &lt;form action=&quot;/Customer/CustomerForm&quot; method=&quot;post&quot;&gt; &lt;table&gt; &lt;tr&gt; &lt;td&gt;Id:&lt;/td&gt; &lt;td&gt;&lt;input id=&quot;CustomerId&quot; type=&quot;text&quot; name=&quot;CustomerId&quot; /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Name:&lt;/td&gt; &lt;td&gt;&lt;input id=&quot;CustomerName&quot; type=&quot;text&quot; name=&quot;CustomerName&quot; /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;IsSubscribedToNewLetter:&lt;/td&gt; &lt;td&gt;&lt;input id=&quot;CustomerisSubscribedToNewsLetter&quot; type=&quot;text&quot; name=&quot;CustomerisSubscribedToNewsLetter&quot; /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;MembershipType:&lt;/td&gt; &lt;td&gt; &lt;select id=&quot;MembershipTypeId&quot; name=&quot;MembershipTypeId&quot;&gt; @foreach (var membershipType in @Model.MembershipTypes) &#123; &lt;option value=@membershipType.Id&gt; @*@membershipType.SignupFee*@ @membershipType.Id &lt;/option&gt; &#125; &lt;/select&gt; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Movie:&lt;/td&gt; &lt;td&gt; &lt;select id=&quot;MovieId&quot; name=&quot;MovieId&quot;&gt; @*@Html.ListBoxFor(model =&gt; model.MovieId, Model.AllMovies, new &#123; size = 8 &#125;)*@ @foreach (var movie in Model.Movies) &#123; &lt;option value=@movie.Id&gt; @movie.Name &lt;/option&gt; &#125; &lt;/select&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;input type=&quot;submit&quot; value=&quot;save&quot;/&gt; &lt;/form&gt;</span><br></pre></td></tr></table></figure>


以下是我的客户视图：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@model IEnumerable&lt;WebApplication2.Models.Customer&gt; @&#123; ViewBag.Title = &quot;Customers&quot;; &#125; &lt;p&gt; @Html.ActionLink(&quot;Create New&quot;, &quot;CustomerForm&quot;) &lt;/p&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;&lt;/th&gt; &lt;th&gt;Number&lt;/th&gt; &lt;th&gt;Name&lt;/th&gt; &lt;th&gt;Subscription&lt;/th&gt; &lt;th&gt;MembershipType signup fee&lt;/th&gt; &lt;th&gt;Movies&lt;/th&gt; &lt;/tr&gt; @foreach (var item in Model) &#123; &lt;tr&gt; &lt;td&gt; @Html.ActionLink(&quot;Edit&quot;, &quot;Edit&quot;, new &#123; id = item.id &#125;) | @Html.ActionLink(&quot;Details&quot;, &quot;Details&quot;, new &#123; id = item.Name &#125;) | @*@Html.ActionLink(&quot;Delete&quot;, &quot;Delete&quot;, new &#123; id = item.id &#125;, new &#123; onclick = &quot;return confirm(&apos;Are you sure you wish to delete this article?&apos;);&quot; &#125;)*@ @*&lt;p&gt;&lt;a href=&quot;/Customer/Edit/@item.id&quot;&gt;Edit Customer&lt;/a&gt;&lt;/p&gt;*@ &lt;form method=&quot;post&quot; action=&quot;/Customer/delete/@item.id&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;delete&quot; /&gt; &lt;/form&gt; &lt;/td&gt; &lt;td&gt; @Html.DisplayFor(modelItem =&gt; item.id) &lt;/td&gt; &lt;td&gt; @Html.DisplayFor(modelItem =&gt; item.Name) &lt;/td&gt; &lt;td&gt; @Html.DisplayFor(modelItem =&gt; item.IsSubscribedToNewsletter) &lt;/td&gt; &lt;td&gt; @Html.DisplayFor(modelItem =&gt; item.CurrentMembershipType.SignupFee) &lt;/td&gt; &lt;td&gt; @foreach (var movie in item.Movies) &#123; @movie.Name &#125; &lt;/td&gt; &lt;/tr&gt; &#125; &lt;/table&gt;</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luna.newban.cn../../c为什么要使用params关键字堆栈内存溢出.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../c为什么要使用params关键字堆栈内存溢出.html" itemprop="url">c为什么要使用params关键字堆栈内存溢出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-08-28T00:00:00+00:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文标题"><a href="#原文标题" class="headerlink" title="原文标题:"></a>原文标题:</h2>
Why use the params keyword?


<h2 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h2>
我知道这是一个基本问题，但我找不到答案。

为什么要使用它？ 如果编写使用该函数的方法或方法，则将其删除时代码仍将完美运行，没有代码的情况下100％正常运行。 例如：

有参数：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static public int addTwoEach(params int[] args) &#123; int sum = 0; foreach (var item in args) sum += item + 2; return sum; &#125;</span><br></pre></td></tr></table></figure>


没有参数：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static public int addTwoEach(int[] args) &#123; int sum = 0; foreach (var item in args) sum += item + 2; return sum; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h2><p><strong>===============&gt;&gt;#1 票数：470 已采纳</strong></p>

使用params您可以这样调用方法： 没有params ，就不能。 此外， 在两种情况下 ，都可以使用数组作为参数来调用该方法： 也就是说， params允许您在调用方法时使用快捷方式。 无关的，您可以大大缩短您的方法：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addTwoEach(1, 2, 3, 4, 5);</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#2 票数：91</strong></p>

使用params可以使您不带参数地调用函数。 没有params ： 与params比较： 通常，当参数数量可以从0到无穷大变化时，可以使用params；当参数数量可以从1到无穷大变化时，可以使用数组。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> static public int addTwoEach(int[] args)</span><br><span class="line">&#123;</span><br><span class="line">    int sum = 0;</span><br><span class="line"></span><br><span class="line">    foreach (var item in args)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += item + 2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">addtwoEach(); // throws an error</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#3 票数：22</strong></p>

它允许您根据需要在调用中添加尽可能多的基本类型参 数。 而对于第二种形式，您必须使用数组作为参数

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addTwoEach(10, 2, 4, 6)</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#4 票数：16</strong></p>

使用params关键字的一种危险是，如果在对方法的调用进行编码之后， 这些调用将继续使用先前用于必需参数的一个/多个表达式进行编译，这些表达式被视为可选的params参数。 我只是遇到了最糟糕的情况： params Parameter是Type object[] 。 这是值得注意的，因为开发人员已经习惯了编译器以更为常见的场景拍手，其中从具有所有必需参数的方法中删除参数（因为预期的参数数量会发生变化）。 对我而言，这不值得捷径。 不带params (Type)[]可以使用0到无穷大数量的参数，而无需覆盖。 最坏的情况是，您必须在不适用的Calls中添加一个, new (Type) [] {} 。 顺便说一句，恕我直言，最安全（也是最易读的做法）是： 通过命名参数传递（我们现在甚至可以在C＃做〜2个后， 几十年来我们可以在VB; P）（这是因为： 1.1。 这是唯一的方法，可以确保防止在对参数进行顺序编码，对Compatible-Type和/或计数进行编码后更改了传递给Parameters的意外值之后， 1.2。 它减少了参数含义更改后的机会，因为反映新含义的可能的新标识符名称就在传递给它的值的旁边， 1.3。 它避免了必须计算逗号并从Call to Signature来回跳转，以查看为什么参数传递了什么Expression，以及 1.3.1。 顺便说一句，仅仅因为这个原因应该是充足的 （以避免频繁出错违反了DRY原则的只是阅读代码更何况还修改而言），但如果有一个这样的原因可能是成倍更重要的/更多传递的表达式本身包含逗号，即多维数组引用或多参数函数调用。 在这种情况下，您甚至无法使用（即使可能， 每个方法调用的每个参数仍要添加一个额外的步骤）在编辑器中的“选择”功能中查找所有事件以自动进行逗号计数。 1.4。 如果必须使用可选参数（ params与否），它可以让你搜索，其中一个特定的可选参数传递调用（因此，最有可能的是没有或者至少有被没有默认值的可能性）， （注意：原因1.2和1.3可以缓解并减少出错的机会，即使在对初始Call进行编码时，更不用说在必须读取和/或更改Call的情况下了。） 和 这样做-参数-每行-以获得更好的可读性（因为： 2.1。 它不那么混乱，并且 2.2。 它避免了向右和向左滚动（并且必须这样做-因为大多数凡人无法读取多行的左侧部分，因此请向右滚动并读取右侧部分）。 2.3。 这与我们已经为赋值语句演变成的“最佳实践”一致，因为传递的每个参数本质上都是赋值语句（分配值或对局部变量的引用）。 就像那些遵循最新的 “最佳实践”编码风格的人不会梦想每行编码多个赋值语句一样，我们可能不应该（而且“最佳实践”不会赶上我的“天才”； P ）在传递参数时执行此操作。 注意事项 ： 在以下情况下，传递名称与“参数”相对应的变量无济于事： 1.1。 您传入的是文字常量（即简单的0/1，false / true或null，即使“'最佳实践'”也可能不需要您使用命名常量，并且无法轻易地从方法名称中推断出它们的用途） ）， 1.2。 该方法的级别比调用者低得多/更为通用，因此您不希望/能够将变量命名为与参数相同/相似（反之亦然），或者 1.3。 您正在重新排序/替换签名中的参数，这可能导致先前的调用仍在编译中，因为类型恰好仍然兼容。 拥有像VS这样的自动换行功能并不能消除我上面给出的8个原因中的一个（＃2.2）。 在VS 2015之前，它没有自动缩进（！？！确实是MS？！？），这会增加原因＃2.1的严重性。 VS应该有一个选项，该选项生成带有命名参数的方法调用摘要（每行当然一个； P），以及一个需要命名参数的编译器选项（概念上与VB中的Option Explicit类似，顺便说一句，对需求的要求很容易想到）同样令人发指，但现在“最佳做法”确实要求这样做 ）。 事实上，“早在我的一天”），于1991年就在几个月到我的职业生涯中，我用之前也（或者甚至已经看到的）语言与命名参数，我不得不防sheeple /“只是因为你可以，并不意味着您应该” /不要盲目地“削减烤肉的末端”的感觉，以模拟它（使用内联注释），而没有看到任何人这样做。 当大多数语法开始使用时，不必使用命名参数（以及其他保存“'precious””源代码击键的语法）。 有没有借口，与现代的硬件和IDE的和更复杂的软件，其中的可读性是很多，很多，重要得多 。 “代码被读取的次数要多于被写入的次数”。 只要您不复制非自动更新的代码，当有人（甚至您自己）以后尝试阅读它时，保存的每个击键都可能成倍增加成本。
**===============>>#5 票数：10**

无需创建重载方法，只需使用一个带有params的方法，如下所示

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> // Call params method with one to four integer constant parameters.</span><br><span class="line">//</span><br><span class="line">int sum0 = addTwoEach();</span><br><span class="line">int sum1 = addTwoEach(1);</span><br><span class="line">int sum2 = addTwoEach(1, 2);</span><br><span class="line">int sum3 = addTwoEach(3, 3, 3);</span><br><span class="line">int sum4 = addTwoEach(2, 2, 2, 2);</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#6 票数：5</strong></p>

添加params关键字本身表明您可以在调用该方法时传递多个参数，如果不使用它，则无法实现。 更加具体： 当您调用上述方法时，可以通过以下任何一种方法来调用它： 但是，当您删除params关键字时，只有上述方法中的第三种方法可以正常工作。 对于第一种和第二种情况，您将得到一个错误。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> static public int addTwoEach(params int[] args)</span><br><span class="line">&#123;</span><br><span class="line">    int sum = 0;</span><br><span class="line"></span><br><span class="line">    foreach (var item in args)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += item + 2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#7 票数：4</strong></p>

params还允许您使用单个参数调用该方法。 即Foo(1); 而不是Foo(new int[] { 1 }); 。 在需要传递单个值而不是整个数组的情况下，对于速记很有用。 它在方法中仍然以相同的方式处理，但是为调用此方法提供了一些便利。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> private static int Foo(params int[] args) &#123;</span><br><span class="line">    int retVal = 0;</span><br><span class="line">    Array.ForEach(args, (i) =&gt; retVal += i);</span><br><span class="line">    return retVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#8 票数：0</strong></p>

还需要强调一件事。 使用params更好，因为它对性能更好。 当您使用params参数调用方法并没有传递给它时： 呼叫： 然后，新版本的.Net Framework会执行此操作（来自.Net Framework 4.6）： 此Array.Empty对象可以在以后由框架重用，因此无需进行冗余分配。 当您这样调用此方法时，将发生这些分配：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> public void ExampleMethod(params string[] args)</span><br><span class="line">&#123;</span><br><span class="line">// do some stuff</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>===============&gt;&gt;#9 票数：0</strong></p>

听起来可能很愚蠢，但是Params不允许多维数组。 而您可以将多维数组传递给函数。

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../169/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../169/">169</a><span class="page-number current">170</span><a class="page-number" href="../171/">171</a><span class="space">&hellip;</span><a class="page-number" href="../173/">173</a><a class="extend next" rel="next" href="../171/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="http://code.newban.cn/archives/">
              
                  <span class="site-state-item-count">1724</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a rel="external nofollow" class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a rel="external nofollow" class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
